<tool id="deseq_parallel" name="DESeqP">
  <description>Determines differentially expressed transcripts from read alignments</description>
  <command> 
      /mnt/galaxyTools/tools/deseq-parallel/src/deseq.sh $anno_input_selected $anno_input.select_anno_format $deseq_out $bam_alignments1 $bam_alignments2 >> $Log_File 
  </command>
  <inputs>
     <conditional name="anno_input">
      <param name="select_anno_format" type="select" label="Genome annotation format" help="Select format of your genome annotation file." >
	<option value="0">GFF3</option>
	<option value="1">AGS</option>
      </param>
      <when value="0"> 
	<param format="gff3" name="anno_input_selected" type="data" label="Genome annotation in GFF3 format" help="Partial genome annotation in GFF3 format describing the known gene structures for the provided genome."/>
      </when>
      <when value="1">
	<param format="gann" name="anno_input_selected" type="data" label="Genome annotation in AGS format" help="Partial genome annotation in AGS format describing the known gene structures for the provided genome."/>
      </when>
   </conditional> 
    <param format="bam" name="bam_alignments1" type="data" label="Sample 1 BAM alignment file" help="BAM alignment file. Can be generated from SAM files using the SAM Tools."/>
    <param format="bam" name="bam_alignments2" type="data" label="Sample 2 BAM alignment file" help="BAM alignment file. Can be generated from SAM files using the SAM Tools."/>
  </inputs>

  <outputs>
    <data format="txt" name="deseq_out" label="DESeq result"/>
   <!-- <data format="gann" name="anno_out" label="Annotation gene structure" >
      <filter>anno_input['select_anno_format'] == "0"</filter>
    </data> -->
    <data format="txt" name="Log_File" label="DESeq log file"/>
  </outputs>

  <tests>
    <test>
      <!--
	command:
	./deseq.sh ../test_data/deseq_c_elegans_WS200-I-regions.gff3 0 ../test_data/genes.mat ../test_data/deseq_c_elegans_WS200-I-regions_deseq.txt ../test_data/deseq_c_elegans_WS200-I-regions-SRX001872.bam ../test_data/deseq_c_elegans_WS200-I-regions-SRX001875.bam
	-->
      <param name="anno_input_selected" value="deseq_c_elegans_WS200-I-regions.gff3" ftype="gff3" />
      <param name="bam_alignments1" value="deseq_c_elegans_WS200-I-regions-SRX001872.bam" ftype="bam" />
      <param name="bam_alignments2" value="deseq_c_elegans_WS200-I-regions-SRX001875.bam" ftype="bam" />
      <output name="deseq_out" file="deseq_c_elegans_WS200-I-regions_deseq.txt" />
    </test>
  </tests>

  <help>

.. class:: infomark

**What it does** 

`DESeq` is a tool for differential expression testing of RNA-Seq data.


**Inputs**

`DESeq` requires three input files to run:

1. Annotation file either in GFF3 or AGS format, containing the necessary information about the transcripts that are to be quantified.
2. The BAM alignment file for sample 1, which stores the read alignments in a compressed format. It can be generated using the `SAM-to-BAM` tool in the NGS: SAM Tools section.
3. The BAM alignment file for sample 2, which stores the read alignments in a compressed format. It can be generated using the `SAM-to-BAM` tool in the NGS: SAM Tools section.

**Output**

`DESeq` generates a text file containing the gene name and the p-value.

------

**Licenses**

If **DESeq** is used to obtain results for scientific publications it
should be cited as [1]_.

**References** 

.. [1] Anders, S and Huber, W (2010): `Differential expression analysis for sequence count data`_. 

.. _Differential expression analysis for sequence count data: http://dx.doi.org/10.1186/gb-2010-11-10-r106

------

.. class:: infomark

**About formats**


**GFF3 format** General Feature Format is a format for describing genes
and other features associated with DNA, RNA and protein
sequences. GFF3 lines have nine tab-separated fields:

1. seqid - The name of a chromosome or scaffold.
2. source - The program that generated this feature.
3. type - The name of this type of feature. Some examples of standard feature types are "gene", "CDS", "protein", "mRNA", and "exon". 
4. start - The starting position of the feature in the sequence. The first base is numbered 1.
5. stop - The ending position of the feature (inclusive).
6. score - A score between 0 and 1000. If there is no score value, enter ".".
7. strand - Valid entries include '+', '-', or '.' (for don't know/care).
8. phase - If the feature is a coding exon, frame should be a number between 0-2 that represents the reading frame of the first base. If the feature is not a coding exon, the value should be '.'.
9. attributes - All lines with the same group are linked together into a single item.

For more information see http://www.sequenceontology.org/gff3.shtml

**AGS format** Annotation Gene Structure Object is an internal
structure that efficiently stores the information from a GFF3 file.

**SAM/BAM format** The Sequence Alignment/Map (SAM) format is a
tab-limited text format that stores large nucleotide sequence
alignments. BAM is the binary version of a SAM file that allows for
fast and intensive data processing. The format specification and the
description of SAMtools can be found on
http://samtools.sourceforge.net/.

------

Version 0.1 (May 2011)

</help>
</tool>
